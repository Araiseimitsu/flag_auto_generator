## 更新履歴

### 2025-12-12

- Tkinter アプリ内で設定JSONを作成/編集/保存/読込できる `ConfigEditor` を追加。
- UIから直接、元xlsxを選択して数式生成・保存が可能に。

### 2025-12-15

- `excel_test.py` のインデント崩れを修正し、`build_request_formulas()` が正しく保存まで到達するように整理。
- Excel保存を原子的（tmp→replace）にし、出力先ファイルがロックされている場合は「再試行/中止」でユーザーに閉じ操作を促す（誤って別ファイルを開く事故を防止）。
- 出力列を `I`〜`SN` に固定し、各列の1行目に `SUMPRODUCT` の集計式を自動投入（範囲は `summary_row_min..summary_row_max`、行ステップは `summary_row_step`）。
- `SUMPRODUCT` 集計式は読みやすい複数行フォーマット（改行付き）で書き込むよう調整。
- 測定行(min)のデフォルトを `9` に変更。
- 設定JSONの保存/読み込みボタンを削除。
- 起動時に画面を最大化。
- 初期の工具サンプルは「前挽き」1件、測定Noは `1` のみに変更。

### 2025-12-16

- UIテーマを `ttkbootstrap` のダーク系テーマに切替え、Tk標準スタイル依存を解消。
- 「元Excelとプレビュー」セクションを追加し、先にExcelを読み込んで対象シートの先頭行をプレビュー確認可能にした。
- 測定不要書き込み設定を基本設定の右カラムに移動し、フォームを横並びで扱いやすく整理。
- 依存ライブラリに `ttkbootstrap` を追加（requirements.txt）。
